<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>Phase Space Langevin Diffusion</p> <h1 id="preliminaries">Preliminaries</h1> <h3 id="sgm">SGM</h3> <p>Forward process SDE for $\mathbf{x}<em>t \in \mathbb{R}^d$: $d\mathbf{x}_t = \mathbf{f}(\mathbf{x}_t, t) dt + \mathbf{G}(t) d \mathbf{w}_t$ The reverse SDE is given by: $d\mathbf{x}_t = (\mathbf{f} (\mathbf{x}_t, t) - \mathbf{G}(t)\mathbf{G}(t)^T \nabla</em>{\mathbf{x}<em>t} \log \mathbf{p}_t(\mathbf{x}_t, t))dt + \mathbf{G}(t) d \bar {\mathbf{w}}_t$ The denoising score matching: $\mathcal{L}(\theta)=\mathbb{E}</em>{\mathbf{x}<em>t \sim p\left(\mathbf{x}_t \mid \mathbf{x}_0\right), \mathbf{x}_0 \sim q</em>{\text {data }}(\mathbf{x}), t \sim \mathcal{U}(0, T)}\left[\left|\mathbf{s}<em>\theta\left(\mathbf{x}_t, t\right)-\nabla</em>{\mathbf{x}_t} \log p\left(\mathbf{x}_t \mid \mathbf{x}_0\right)\right|^2\right]$</p> <h3 id="sampling">Sampling</h3> <p>Given $p_s(\mathbf{z}) \propto \exp(- H(\mathbf{z}))$, sampling SDE:</p> <ul> <li> <img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697932448678-33b2275d-45a3-4f85-bf17-9ce9feeaaf30.png#averageHue=%23e7e7e7&amp;clientId=uc38b8078-9b77-4&amp;from=paste&amp;height=29&amp;id=uf2a3f6e8&amp;originHeight=54&amp;originWidth=403&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=10340&amp;status=done&amp;style=none&amp;taskId=u885c7c35-8be7-4800-bc1e-84c6b9c1430&amp;title=&amp;width=215.5" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697932488641-0e67a9f2-1016-4929-8107-5c5361613828.png#averageHue=%23ededed&amp;clientId=uc38b8078-9b77-4&amp;from=paste&amp;height=35&amp;id=uc65a40f5&amp;originHeight=70&amp;originWidth=546&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=13666&amp;status=done&amp;style=none&amp;taskId=u2c1cc1a3-67fa-48a6-a6aa-c0620f2cda2&amp;title=&amp;width=273" alt="image.png"> </li> <li>$\mathbf{f}(\mathbf{z})=-[\mathbf{D}(\mathbf{z})+\mathbf{Q}(\mathbf{z})] \nabla H(\mathbf{z})+\Gamma(\mathbf{z}), \quad \Gamma_i(\mathbf{z})=\sum_{j=1}^d \frac{\partial}{\partial \mathbf{z}<em>j}\left(\mathbf{D}</em>{i j}(\mathbf{z})+\mathbf{Q}_{i j}(\mathbf{z})\right)$ <ul> <li>$\mathbf{D(z)}$: a <strong>positive semideÔ¨Ånite</strong> diffusion matrix; the strength of the Wienerprocess-driven diffusion.</li> <li>$\mathbf{Q(z)}$ is a <strong>skew-symmetric</strong> curl matrix; the deterministic traversing effects.</li> <li>Adjuct $\mathbf{D(z)}$and $\mathbf{Q(z)}$to attain faster convergenve</li> </ul> </li> </ul> <h1 id="psld">PSLD</h1> <p>$p_s(\mathbf{z})=\mathcal{N}\left(\mathbf{x} ; \mathbf{0}<em>{d_x}, \boldsymbol{I}</em>{d_x}\right) \mathcal{N}\left(\mathbf{0}<em>{d_m}, M \boldsymbol{I}</em>{d_m}\right)$</p> <h3 id="forward-sde">Forward SDE</h3> <p>The choice of momentum $\mathbf{m}_t\in \mathbb{R}^d$ The choice of $\mathbf{D}$and $\mathbf{Q}$: <img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697931713095-3ff44b0c-d3ee-4d04-9305-0a03f2b0c984.png#averageHue=%23f3f0f0&amp;clientId=ufee8c02a-34b5-4&amp;from=paste&amp;height=66&amp;id=ue96fc47d&amp;originHeight=131&amp;originWidth=770&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=27174&amp;status=done&amp;style=none&amp;taskId=ub7b8b5de-3911-48c6-b684-9f391e774be&amp;title=&amp;width=385" alt="image.png"> Above $\Gamma, \, M, \, v, \, \beta$are positive scalars. The forward process is given by: <img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697931924336-917cd57f-a7ef-4812-9ec5-6a10134a9503.png#averageHue=%23f2f2f2&amp;clientId=ufee8c02a-34b5-4&amp;from=paste&amp;height=133&amp;id=u0728707f&amp;originHeight=265&amp;originWidth=597&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=40389&amp;status=done&amp;style=none&amp;taskId=uff0786fd-f9d7-4f84-a4e3-39f0e22cfa1&amp;title=&amp;width=298.5" alt="image.png"></p> <h3 id="reverse-sde">Reverse SDE</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697932640475-29cb8b10-7f24-403d-a8aa-2498c4350bc5.png#averageHue=%23f3f3f3&amp;clientId=ub27ee31f-3ecd-4&amp;from=paste&amp;height=142&amp;id=ub48eb5b5&amp;originHeight=283&amp;originWidth=755&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=50084&amp;status=done&amp;style=none&amp;taskId=u7d9f9daf-73fb-43fb-bb04-3e663eb30b4&amp;title=&amp;width=377.5" alt="image.png"></p> <h3 id="sde-solver-sscs">SDE solver: SSCS</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697932782337-65ee40e1-410e-42ac-8d5a-c59fba1e9dca.png#averageHue=%23f3f3f3&amp;clientId=ub27ee31f-3ecd-4&amp;from=paste&amp;height=140&amp;id=ue1a71e05&amp;originHeight=279&amp;originWidth=689&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=47567&amp;status=done&amp;style=none&amp;taskId=uf142f8ab-000f-48ef-b3c2-5d0deb1b237&amp;title=&amp;width=344.5" alt="image.png"></p> <h3 id="training-objectives">Training Objectives</h3> <p>$\min <em>{\boldsymbol{\theta}} \mathbb{E}_t \mathbb{E}</em>{p\left(\mathbf{z}<em>0\right)} \mathbb{E}</em>{p_t\left(\mathbf{z}<em>t \mid \mathbf{z}_0\right)}\left[\mathcal{L}_x\left(\boldsymbol{\theta}, \mathbf{z}_t, \mathbf{z}_0\right)+\mathcal{L}_m\left(\boldsymbol{\theta}, \mathbf{z}_t, \mathbf{z}_0\right)\right]$ $\begin{aligned} \mathcal{L}_x &amp; =\Gamma \beta\left|\left.\mathbf{s}</em>{\boldsymbol{\theta}}\left(\mathbf{z}<em>t, t\right)\right|</em>{0: d}-\nabla_{\mathbf{x}<em>t} \log p_t\left(\mathbf{z}_t \mid \mathbf{z}_0\right)\right|_2^2, \ \mathcal{L}_m &amp; =M \nu \beta\left|\left.\mathbf{s}</em>{\boldsymbol{\theta}}\left(\mathbf{z}<em>t, t\right)\right|</em>{d: 2 d}-\nabla_{\mathbf{m}_t} \log p_t\left(\mathbf{z}_t \mid \mathbf{z}_0\right)\right|_2^2,\end{aligned}$</p> </body></html>