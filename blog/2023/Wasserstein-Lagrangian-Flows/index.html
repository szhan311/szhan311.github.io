<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>A Computational Framework For Solving Wassertein Lagrangian Flows | Shaorong Zhang (张少荣)</title> <meta name="author" content="Shaorong R. Zhang"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script defer src="https://tikzjax.com/v1/tikzjax.js"></script> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://szhan311.github.io//blog/2023/Wasserstein-Lagrangian-Flows/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Shaorong Zhang (张少荣)</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/gallery/">photo gallery</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">A Computational Framework For Solving Wassertein Lagrangian Flows</h1> <p class="post-meta">December 13, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/literature-review"> <i class="fa-solid fa-hashtag fa-sm"></i> Literature-review</a>     ·   <a href="/blog/category/optimal-transport"> <i class="fa-solid fa-tag fa-sm"></i> Optimal-transport</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="preliminaries">Preliminaries</h1> <h2 id="machanics">Machanics</h2> <p>Curves: \(\gamma(t): [0:1] \rightarrow \mathcal{X}\); Velocity \(\dot{\gamma_t} \in \mathcal{T}_{\gamma(t)} \mathcal{X}\); Lagrangian function: \(L(\gamma_t \dot{\gamma_t}, t)\).</p> <p>Given two endpoints \(x_0, x_1 \in \mathcal{X}\), define the <em><strong>action</strong></em> as the time integral \(\mathcal{A}(\gamma)=\int_0^1 L\left(\gamma_t, \dot{\gamma}_t, t\right) d t\).</p> <p>Minimize the action along all curves: \(c\left(x_0, x_1\right)=\inf _{\gamma \in \Pi\left(x_0, x_1\right)} \mathcal{A}(\gamma)=\inf _{\gamma_t} \int_0^1 L\left(\gamma_t, \dot{\gamma}_t, t\right) d t \quad\).</p> <p>Lagrangian flows: we refer to the optimizing curves \(\gamma^*(x_0, x_0)\) as Lagrange flows, which satisfy the Euler-Lagrange equation \(\frac{d}{d t} \frac{\partial}{\partial \dot{\gamma}_t} L\left(\gamma_t, \dot{\gamma}_t, t\right)=\frac{d}{d \gamma_t} L\left(\gamma_t, \dot{\gamma}_t, t\right)\).</p> <p>Assume that \(L(\gamma_t, \dot{\gamma}_t, t)\) is strictly convex in the velocity \(\dot{\gamma}_t\), then we can obtain an equivalent, Hamiltonian perspective. Define the Hamiltonian \(H\left(\gamma_t, p_t, t\right)\) as the Legendre transform of \(L\) with respect to \(\dot{\gamma}_t\),</p> \[H\left(\gamma_t, p_t, t\right)=\sup _{\dot{\gamma}_t}\left\langle\dot{\gamma}_t, p_t\right\rangle-L\left(\gamma_t, \dot{\gamma}_t, t\right)\] <p>The Euler-Lagrange equations can be written as Hamiltion’s equation in phase space \(\dot{\gamma}_t=\frac{\partial}{\partial p_t} H\left(\gamma_t, p_t, t\right) \quad \dot{p}_t=-\frac{\partial}{\partial \gamma_t} H\left(\gamma_t, p_t, t\right)\)</p> <h2 id="basic-of-math">Basic of math</h2> <p>**Deﬁnition (Image measure or push forward measure): **take a map \(T:X \rightarrow Y\) and a probability measure \(\mu \in \mathcal{P} (Y)\) as: \(\left(T_{\#} \mu\right)(A):=\mu\left(T^{-1}(A)\right)\) for any \(A \in \mathcal{B}(Y)\)</p> <p><strong>Deﬁnition (Tangent space)</strong>: Given a point \(p \in M\), the tangent space \(T_p M \subset \mathbb{R}^D\) of \(M\) at \(p\) is defined as \(T_p M:=\{\dot{\gamma}(0) \mid \gamma:(-1,1) \rightarrow M, \gamma(0)=p\}\). Intuitively, the tangent space contains all the directions tangent to \(M\) at \(p\).</p> <p><strong>Deﬁnition (Riemannian distance)</strong>: Given two points \(x, y \in M\), their Riemannian distance \(d_{M}(x, y)\) is defined as \(d_M(x, y):=\inf \left\{\int_a^b \vert \dot{\gamma}(t) \vert d t \mid \gamma:[a, b] \rightarrow M, \gamma(a)=x, \gamma(b)=y\right\}\).</p> <p>\(X\) and \(Y\) are locally compact, separable, and complete metric spaces.</p> <p><strong>Deﬁnition (Minimizing geodesic)</strong>: A curve \(\gamma : [a,b] \rightarrow M\) with constant speed such that \(\gamma(a) = x, \gamma(b) = y\), and whose length is equal to \(d_M (x, y)\), is called a minimizing geodesic.</p> <h2 id="transport-maps--coupling">Transport maps &amp; coupling</h2> <p>**Definition (Transport map): **Given \(\mu \in \mathcal{P}(X)\) and \(v \in \mathcal{P}(Y)\), a map \(T: X \rightarrow Y\) is called a transport map from \(\mu\) to \(v\) if \(T_{\#} \mu = v\)</p> <p><strong>Definition (Coupling or transport plan):</strong> We call \(\gamma \in \mathcal{P}(X \times Y)\) a coupling of \(\mu\) and \(v\) if</p> <p>\(\left(\pi_X\right)_{\#} \gamma=\mu \quad \text { and } \quad\left(\pi_Y\right)_{\#} \gamma=v \text {, }\) where \(\pi_X(x, y)=x, \quad \pi_Y(x, y)=y \quad \forall(x, y) \in X \times Y\). We denote by \(\Gamma(\mu, v)\) the set of couplings of \(\mu\) and \(v\).</p> <p>**Remark: **Given \(\mu\) and \(v\), the set \(\Gamma(\mu, v)\) is always nonempty, indeed the product measure \(\gamma = \mu \otimes v\) (defined by \(\int \phi(x, y) d \gamma(x, y)=\int \phi(x, y) d \mu(x) d \nu(y)\)) for every \(\phi: X \times Y \rightarrow \mathbb{R}\) is a coupling.</p> <p><strong>Remark (Transport map vs. coupling)</strong>. Let \(T: X \rightarrow Y\) satisfy \(T_{\#} \mu=v\). Consider the map\(\operatorname{Id} \times T: X \rightarrow X \times Y\), i.e., \(x \mapsto(x, T(x))\), and define\(\gamma_T:=(\operatorname{Id} \times T)_{\#} \mu \in \mathcal{P}(X \times Y)\), we claim that \(\gamma_T \in \Gamma(\mu, v)\). This proves that any transport map \(T\) includes a coupling \(\gamma_T\).</p> <h2 id="optimal-transport">Optimal Transport</h2> <p>Two kinds of formulation: <strong>Monge</strong> formulation and <strong>Kantorovich</strong> formulation</p> <h1 id="sketch">Sketch</h1> <h2 id="how-to-calculate-the-action-of-rho_t">How to calculate the action of \(\rho_t\)</h2> <p>Given Lagrangian function \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]\), the action is \(A_L[\rho_t]=\int_0^1 \mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right] d t\)</p> <p>Recall the definition of the Legendre transform for \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]\) strictly convex in \(\dot{\rho}_t\),</p> \[\begin{aligned} &amp; \mathcal{H}\left[\rho_t, s_t, t\right]=\sup _{\dot{\rho}_t \in \mathcal{T}_{\rho_t} \mathcal{P}} \int \dot{\rho}_t s_t d x_t-\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right] \\ &amp; \mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]=\sup _{s_t \in \mathcal{T}_{\rho_t}^* \mathcal{P}} \int \dot{\rho}_t s_t d x_t-\mathcal{H}\left[\rho_t, s_t, t\right]\end{aligned}\] <p>The action \(A_L[\rho_t]\) is the solution to the inneroptimization</p> \[\mathcal{A}_{\mathcal{L}}\left[\rho_t\right]=\sup _{s_t} \int s_1 \mu_1 d x_1-\int s_0 \mu_0 d x_0-\int_0^1\left(\int \frac{\partial s_t}{\partial t} \rho_t d x_t+\mathcal{H}\left[\rho_t, s_t, t\right]\right) d t\] <h2 id="how-to-minimize-the-action">How to minimize the action</h2> <p>The optimization\(\mathcal{S}=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \mathcal{A}_{\mathcal{L}}\left[\rho_t\right]=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \int_0^1 \mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right] d t\) is equivalent to the following dual</p> \[\mathcal{S}=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \sup _{s_t} \int s_1 \mu_1 d x_1-\int s_0 \mu_0 d x_0-\int_0^1\left(\int \frac{\partial s_t}{\partial t} \rho_t d x_t+\mathcal{H}\left[\rho_t, s_t, t\right]\right) d t\] <p>So we have two goals</p> <ul> <li> <p><strong>Inner optimization:</strong> evaluating the action functional \(\mathcal{A}_{\mathcal{L}}\left[\rho_t\right]\) for a given curve \(\rho_t\)</p> </li> <li> <p>**Outer optimization: **optimizing the action over curves \(\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)\) satisfying the desired constraints</p> </li> </ul> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/optimal%20transport/wlf-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/optimal%20transport/wlf-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/optimal%20transport/wlf-1400.webp"></source> <img src="/assets/img/optimal%20transport/wlf.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h2 id="hamiltonian-optimality-conditions">Hamiltonian optimality conditions</h2> <p>\(\frac{\partial \rho_t}{\partial t}=\frac{\delta}{\delta s_t} \mathcal{H}\left[\rho_t, s_t, t\right]\) and \(\frac{\partial s_t}{\partial t}=-\frac{\delta}{\delta \rho_t} \mathcal{H}\left[\rho_t, s_t, t\right]\)</p> <h1 id="a-special-class-of-lagrangians">A special class of Lagrangians</h1> <p>Definition 3.1 ((Dual) Linearizability). A Lagrangian \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]\) is dual linearizable if the corresponding Hamiltonian \(\mathcal{H}\left[\rho_t, s_t, t\right]\) can be written as a linear functional of the density \(\rho_t\). In other words, \(\mathcal{H}\left[\rho_t, s_t, t\right]\) is linearizable if there exist functions \(K^*\left(x_t, s_t, t\right)\), and \(U\left(x_t, s_t, t\right)\) such that \(\mathcal{H}\left[\rho_t, s_t, t\right]=\int\left(K^*\left(x_t, s_t, t\right)+U\left(x_t, s_t, t\right)\right) \rho_t d x_t\)</p> <h1 id="parameterization">Parameterization</h1> <p>We parameterize \(s_t\) as a neural network \(s_t(x, \theta)\), we parameterize the distribution path \(\rho_t(x, \eta)\) as a generative model \(x_t=(1-t) x_0+t x_1+t(1-t) \mathrm{NNET}\left(t, x_0, x_1, \eta\right), \quad x_0 \sim \mu_0, \quad x_1 \sim \mu_1\).</p> <h2 id="reparameterization-trick">Reparameterization trick</h2> <p>For linearizable dual objectives, we optimize</p> \[\begin{aligned} \operatorname{LOSS}(\theta, \eta)=\min _\eta \max _\theta \int s_1(x, \theta) \mu_1 d x_1-\int s_0(x, \theta) \mu_0 d x_0 \\ \quad-\int_0^1 \int\left(\frac{\partial s_t}{\partial t}(x, \theta)+K^*\left(s_t(x, \theta), t\right)+U\left(s_t(x, \theta), t\right)\right) \rho_t(x, \eta) d x d t\end{aligned}\] <p>Given this objective, we see that minimizing \(\eta\) and maximizing \(\theta\) are seperatable.</p> <p>An alternative to parametrizing the distribution path \(\rho_t\) is perform minimization of the LOSS via the Wasserstein gradient flow</p> \[x_t^{\prime}=x_t+\alpha \cdot t(1-t) \nabla_x\left[\frac{\partial s_t}{\partial t}\left(x_t, \theta\right)+K^*\left(s_t\left(x_t, \theta\right), t\right)+U\left(s_t\left(x_t, \theta\right), t\right)\right]\] <h2 id="algorithm">Algorithm</h2> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1699855255705-28c77fbc-0f50-4140-9ebe-fa296b5e2965.png#averageHue=%23eeeeee&amp;clientId=u65838f34-583e-4&amp;from=paste&amp;height=318&amp;id=J95gc&amp;originHeight=504&amp;originWidth=1177&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=143483&amp;status=done&amp;style=none&amp;taskId=u0e294a81-e410-487f-bb00-11fb2e0db96&amp;title=&amp;width=742.5" alt="image.png"></p> <h1 id="wassertein-2-geometry">Wassertein-2 Geometry</h1> <h2 id="definition">Definition</h2> <p>Given two densities with finite second moments \(\mu_0, \mu_1 \in \mathcal{P}_2(\mathcal{X})\), the Wassertein-2 OT problem is defined , in the Kantorovich formulation, as a cost-minimization problem over joint distributions \(\pi \in \Pi\left(\mu_0, \mu_1\right)=\left\{\pi\left(x_0, x_1\right) \mid \int \pi\left(x_0, x_1\right) d x_1=\mu_0, \int \pi\left(x_0, x_1\right) d x_0=\mu_1\right\}\), i.e.</p> \[W_2\left(\mu_0, \mu_1\right)^2:=\inf _{\pi \in \Pi\left(\mu_0, \mu_1\right)} \int\left \| x_0-x_1\right \|^2 \pi\left(x_0, x_1\right) d x_0 d x_1\] <h2 id="an-alternative-perspective-dynamical-formulation">An alternative perspective (dynamical formulation)</h2> <p>An alternative perspective on the \(W_2\) OT problem as an optimization over a vector field \(v_t\) that transports samples according to an ODE \(\dot x_t = v_t\).</p> <p>The evolution of samples’ density \(\rho_t\), under transport by \(v_t\), is governed by the continuity equation \(\dot{\rho}_t = - \nabla \cdot (\rho_t v_t)\), and we have</p> <p>\(W_2\left(\mu_0, \mu_1\right)^2=\inf _{\rho_t} \inf _{v_t} \int_0^1 \int \frac{1}{2}\left\| v_t\right \|^2 \rho_t d x_t d t \quad\) s.t. \(\dot{\rho}_t=-\nabla \cdot\left(\rho_t v_t\right), \quad \rho_0=\mu_0, \rho_1=\mu_1\) where \(\nabla \cdot ()\) is the divergence operator.</p> <p>The \(W_2\) transport cost can be viewed as providing a Riemannian mannifold structure on the space of densities \(\mathcal{P}_2(\mathcal{X})\)</p> <h1 id="wassertein-fisher-rao-geometry">Wassertein Fisher-Rao Geometry</h1> <ul> <li>consider additional terms allowing for birth and death of particles</li> </ul> <p>Extending the continuity equation to include a ‘growth term’ \(g_t: \mathcal{X}, \rightarrow \mathbb{R}\), the objective is</p> \[W F R_\lambda\left(\mu_0, \mu_1\right)^2=\inf _{\rho_t} \inf _{v_t, g_t} \int_0^1 \int\left(\frac{1}{2}\left\|v_t\right\|^2+\frac{\lambda}{2} g_t^2\right) \rho_t d x_t d t\] <p>subject to \(\dot{\rho}_t=-\nabla \cdot\left(\rho_t v_t\right)+\lambda \rho_t g_t, \rho_0=\mu_0, \rho_1=\mu_1\) We call this the <em><strong>Wasserstein Fisher-Rao (WFR)</strong></em> distance, this problem is reffered as <strong>unbalanced OT problem</strong></p> <h2 id="a-riemanian-structure-on-mathcalmmathcalx">A Riemanian structure on \(\mathcal{M}(\mathcal{X})\)</h2> <p>A Riemanian structure on \(\mathcal{M}(\mathcal{X})\) via the WFR distance. Introducting Lagrange multipliers \(s_t\) and eliminating \(v_t\), \(g_t\) yields the optimality conditions \(v_t = \nabla s_t\) and \(g_t = s_t\). This suggests characterizing the tangent space via the tuple \(\left(s_t, \nabla s_t\right)\) and define the metric as \(\begin{aligned} T_\rho^{W F R_\lambda} \mathcal{M}(\mathcal{X}) &amp; =\{\dot{\rho} \mid \dot{\rho}=-\nabla \cdot(\rho \nabla s)+\lambda \rho s\} \\ \left\langle\dot{\mu}_t, \dot{\rho}_t\right\rangle_{T_\rho}^{W F R_\lambda} &amp; =\left\langle s_{\dot{\mu}_t}, s_{\dot{\rho}_t}\right\rangle_{T_\rho^*}^{W F R_\lambda}=\int\left(\left\langle\nabla s_{\dot{\mu}_t}, \nabla s_{\dot{\rho}_t}\right\rangle+\lambda s_{\dot{\mu}_t} s_{\dot{\rho}_t}\right) \rho d x .\end{aligned}\)</p> <h1 id="action-matching">Action Matching</h1> <p>The objective is \(\mathcal{A}\left[\mu_t\right]=\sup _{s_t} \int s_1 \mu_1 d x_1-\int s_0 \mu_0 d x_0-\int_0^1 \int\left(\frac{\partial s_t}{\partial t}+\frac{1}{2}\left\|\nabla s_t\right\|^2\right) \mu_t d x_t d t\) \(s_t: \mathcal{X}\times [0, 1] \rightarrow \mathbb{R}\) is parameterized by a neural network, with similar objective for \(WFR_{\lambda}\) we view Action Matching as maximizing a lower bound on the action \(\mathcal{A}[\mu_t]\) or kinetic energy of the curve \(\mu_t : [0, 1] \rightarrow \mathcal{P}_2(\mathcal{X})\) of densities. In particular, at those optimal \(s_{\dot{\mu_t}}\) satisfying \(\dot{\mu}_t=-\nabla \cdot\left(\mu_t \nabla s_{\dot{\mu}_t}\right)\), \(\mathcal{A}\left[\mu_t\right]=\int_0^1 \frac{1}{2}\left\langle\dot{\mu}_t, \dot{\mu}_t\right\rangle_{T_{\mu_t}}^{W_2} d t=\int_0^1 \frac{1}{2}\left\langle s_{\dot{\mu}_t}, s_{\dot{\mu}_t}\right\rangle_{T_{\mu_t}^*}^{W_2} d t=\int_0^1 \int \frac{1}{2}\left\|\nabla s_t\right\|^2 \mu_t d x_t d t\)</p> <h1 id="wassertein-lagrangian-flows">Wassertein Lagrangian Flows</h1> <h2 id="wassertein-lagrangian-and-hamiltonian-flows">Wassertein Lagrangian and Hamiltonian Flows</h2> \[\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]=\mathcal{K}\left[\rho_t, \dot{\rho}_t, t\right]-\mathcal{U}\left[\rho_t, t\right]\] <p>define the action of a curve: \(\mathcal{A}(\rho_t)=\int_0^1 L\left(\rho_t, \dot{\rho}_t, t\right) d t\).</p> <p>seek the action-minimizing curve subject to the constraints:</p> \[\begin{aligned} \mathcal{S}_{\mathcal{L}}\left(\left\{\mu_{t_i}\right\}_{i=0}^{M-1}\right) &amp; :=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \mathcal{A}_{\mathcal{L}}\left[\rho_t\right] \\ &amp; :=\inf _{\rho_t} \int_0^1 \mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right] d t \quad \text { s.t. } \rho_{t_i}=\mu_{t_i} \quad \forall 0 \leq i \leq M-1\end{aligned}\] <p>where \(\Gamma\left(\left\{\mu_{t_i}\right\}\right)=\left\{\rho_t:[0,1] \rightarrow \mathcal{P}(\mathcal{X}) \mid \rho_0=\mu_0, \rho_1=\mu_1, \rho_{t_i}=\mu_{t_i} \quad(\forall 1 \leq i \leq M-2)\right\}\)</p> <p>Define the Hamiltonian via Legendre transform:</p> \[\mathcal{H}\left[\rho_t, s_t, t\right]=\sup _{\dot{\rho}_t \in T_{\rho_t} \mathcal{P}} \int \dot{\rho}_t s_t d x_t-\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]=\mathcal{K}^*\left[\rho_t, s_t, t\right]+\mathcal{U}\left[\rho_t, t\right]\] <p>Finally, \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]\) can be written using the Legendre transform \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]=\sup _{s_t \in T_{\rho_t}^* \mathcal{P}} \int \dot{\rho}_t s_t d x_t-\mathcal{H}\left[\rho_t, s_t, t\right]\)</p> <p>The following theorem forms the basis for our computational approach</p> <p>Theorem 1. For a Lagrangian \(\mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right]\) which is lsc and strictly convex in \(\dot{\rho}_t\), the optimization</p> \[\mathcal{S}=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \mathcal{A}_{\mathcal{L}}\left[\rho_t\right]=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \int_0^1 \mathcal{L}\left[\rho_t, \dot{\rho}_t, t\right] d t\] <p>is equivalent to the following dual</p> \[\mathcal{S}=\inf _{\rho_t \in \Gamma\left(\left\{\mu_{t_i}\right\}\right)} \sup _{s_t} \int s_1 \mu_1 d x_1-\int s_0 \mu_0 d x_0-\int_0^1\left(\int \frac{\partial s_t}{\partial t} \rho_t d x_t+\mathcal{H}\left[\rho_t, s_t, t\right]\right) d t\] <p>Next, we have Wasserstein Hamiltonian flows satisfy the optimality conditions</p> <p>\(\frac{\partial \rho_t}{\partial t}=\frac{\delta}{\delta s_t} \mathcal{H}\left[\rho_t, s_t, t\right]\)and \(\frac{\partial s_t}{\partial t}=-\frac{\delta}{\delta \rho_t} \mathcal{H}\left[\rho_t, s_t, t\right]\)</p> <p>#</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Action-Maching/">Action matching</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/EDM/">Elucidating the Design Space of Diffusion-Based Generative Models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Reverse-time-Diffusion-Equation-Models/">Reverse time diffusion equation models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/SGM-(NCSN)/">Generative Modeling by Estimating Gradients of the Data Distribution</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/CLD/">Score-based generative modeling with critically-damped Langevin diffusion</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Shaorong R. Zhang. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script>var wechatModal=document.getElementById("WeChatMod"),wechatBtn=document.getElementById("WeChatBtn");wechatBtn.onclick=function(){wechatModal.style.display="block"},window.onclick=function(t){t.target==wechatModal&&(wechatModal.style.display="none")};</script> </body> </html>