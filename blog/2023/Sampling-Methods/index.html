<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h3 id="hamiltonian-monte-carlo-and-its-varients">Hamiltonian Monte Carlo and its varients</h3> <p>Gibbs canonical distribution: $p(\textbf{x}) \propto \exp \left(-\frac{U(\textbf{x})}{T}\right)$ $H(\textbf{x}) = U(\textbf{x}) + K(\textbf{v})$ $p(\textbf{x, v}) \propto \exp \left(-\frac{H(\textbf{x})}{T}\right) = \exp \left(-\frac{U(\textbf{x})}{T}\right)\exp \left(-\frac{K(\textbf{v})}{T}\right) \propto p(\textbf{x}) p(\textbf{v})$ $p(\textbf{v}) \propto \exp (-\frac{1}{2} \textbf{v}^T \textbf{v})$, $K(\textbf{v}) = -\log p(\textbf{v}) \propto \frac{1}{2} \textbf{v}^T \textbf{v}$ $U(\textbf{x}) = -\log p(\textbf{x})$, $\nabla_x U = - \nabla_x \log p(\textbf{x})$</p> <ul> <li> <strong>Variables</strong>: Target variables (position term): $\mathbf{x}$; Auxiliary variables (momentum term): $\mathbf{v}$; $\mathbf{z = (x, v)}$</li> <li> <strong>Why auxiliary</strong>: auxiliary variables provide <strong>efficient exploration</strong> </li> <li> <strong>Marginalizing</strong>: marginalizing the the auxiliary variables of $p\mathbf{(x,v)}$we get $p(\mathbf{x})$</li> <li> <strong>Jump process</strong>: added to **ensure ergodicity, **e.g., momentum resampling</li> <li>**Stationary ergodic process: **ensure simulating from the process can be equated with drawing samples from the posterior</li> <li> <strong>Metropolis-Hastings (MH) correction</strong>: applied if the stationary distribution is not the target distribution; HMC have a <strong>low rejection rate</strong> </li> <li>LMC:$\mathrm{d} X_t=-\nabla U\left(X_t\right) \mathrm{d} t+\sqrt{2} \mathrm{~d} B_t$ <h3 id="a-complete-recipe-for-stochastic-gradient-mcmc">A Complete Recipe for Stochastic Gradient MCMC</h3> </li> <li> <strong>Target distribution</strong>: $p^s(\mathbf{z}) \propto \exp (-H(\mathbf{z}))$</li> <li> <strong>SDE with specified target dsitribution</strong>: $\mathrm{d} \mathbf{z}=\mathbf{f}(\mathbf{z}) \mathrm{d} t+\sqrt{2 \mathbf{D}(\mathbf{z})} \mathrm{d} \mathbf{W}(t)$</li> <li>$\mathbf{f}(\mathbf{z})=-[\mathbf{D}(\mathbf{z})+\mathbf{Q}(\mathbf{z})] \nabla H(\mathbf{z})+\Gamma(\mathbf{z}), \quad \Gamma_i(\mathbf{z})=\sum_{j=1}^d \frac{\partial}{\partial \mathbf{z}<em>j}\left(\mathbf{D}</em>{i j}(\mathbf{z})+\mathbf{Q}_{i j}(\mathbf{z})\right)$ <ul> <li>$\mathbf{D(z)}$: a <strong>positive semideÔ¨Ånite</strong> diffusion matrix; the strength of the Wienerprocess-driven diffusion.</li> <li>$\mathbf{Q(z)}$ is a <strong>skew-symmetric</strong> curl matrix; the deterministic traversing effects.</li> <li>Adjuct $\mathbf{D(z)}$and $\mathbf{Q(z)}$to attain faster convergenve</li> </ul> </li> <li>**Stationary proof: ** <ul> <li>Fokker-Planck equation: $\partial_t p(\mathbf{z}, t)=-\sum_i \frac{\partial}{\partial \mathbf{z}<em>i}\left(\mathbf{f}_i(\mathbf{z}) p(\mathbf{z}, t)\right)+\sum</em>{i, j} \frac{\partial^2}{\partial \mathbf{z}<em>i \partial \mathbf{z}_j}\left(\mathbf{D}</em>{i j}(\mathbf{z}) p(\mathbf{z}, t)\right)$</li> <li>$\partial_t p(\mathbf{z}, t)=\nabla^T \cdot([\mathbf{D}(\mathbf{z})+\mathbf{Q}(\mathbf{z})][p(\mathbf{z}, t) \nabla H(\mathbf{z})+\nabla p(\mathbf{z}, t)]) = 0$, when we replace $p(\mathbf{z}, t)$as $e^{-H(\mathbf{z})}$ <h3 id="hamiltonian-dynamics-with-non-canonical-momentum">Hamiltonian Dynamics with Non-canonical Momentum</h3> </li> </ul> </li> <li> <strong>Microcanonical Hamiltonian Monte Carlo</strong> <ul> <li>**ODE: **$\begin{aligned} &amp; \dot{\boldsymbol{x}}=\boldsymbol{u} \ &amp; \dot{\boldsymbol{u}}=P(\boldsymbol{u}) \boldsymbol{f}(\boldsymbol{x})\end{aligned}$ <ul> <li>the projector $P\mathbf{(u) = I - uu^T}$, the force $\mathbf{f(x) = - \nabla S(x)}/ (d-1)$</li> </ul> </li> <li> <strong>The Liouville equation</strong>: $\dot{\rho}(\boldsymbol{z})=-\nabla \cdot(\rho \boldsymbol{B}) \equiv \sum_{i=1}^{2 d-1} \frac{\partial}{\partial z^i}\left(\rho(\boldsymbol{z}) B^i(\boldsymbol{z})\right)$</li> <li> <strong>The stationary solution</strong> of Liouville equation: $\rho_{\infty} \propto e^{-S(\mathbf{x})} \sqrt{g(\mathbf{v})}$, $\dot{\rho}_{\infty} = 0$</li> </ul> </li> <li> <strong>Microcanonical Langevin Monte Carlo</strong> <ul> <li>**SDE: **$\begin{aligned} &amp; d{\boldsymbol{x}}=\boldsymbol{u} dt\ &amp; d{\boldsymbol{u}}=P(\boldsymbol{u}) \boldsymbol{f}(\boldsymbol{x})dt + \eta P(\mathbf{u})d\mathbf{W}\end{aligned}$</li> <li> <strong>The Fokker-Planck equation:</strong> $\dot{\rho} = -\nabla \cdot (\rho \mathbf{B}) + \frac{\eta^2}{2} \hat{\nabla}^2 \rho$</li> <li> <strong>The stationary solution</strong> of the Fokker-Planck equation: $\dot{\rho}<em>{\infty} = 0 + \hat{\nabla}^2\rho</em>{\infty} = 0$</li> </ul> </li> </ul> </body></html>