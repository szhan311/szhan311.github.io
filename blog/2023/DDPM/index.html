<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h1 id="background">Background</h1> <h3 id="vlb-bound">VLB Bound</h3> <p>$\begin{align} &amp; \mathbb{E}<em>{q(\mathbf{x}_0)}[-\log p</em>{\theta}(\mathbf{x}<em>0)] \ &amp;= -\mathbb{E}</em>{q(\mathbf{x}<em>0)}[\log (p</em>{\theta}(\mathbf{x}<em>0) \int p</em>{\theta} (\mathbf{x}<em>{1:T})d\mathbf{x}</em>{1:T})] <br> &amp;= -\mathbb{E}<em>{q(\mathbf{x}_0)}[ \log(\int p</em>{\theta} (\mathbf{x}<em>{0:T})d\mathbf{x}</em>{1:T})] <br> &amp;= -\mathbb{E}<em>{q(\mathbf{x}_0)}[\log (\int q (\mathbf{x}</em>{1:T}|\mathbf{x}<em>0) \frac{ p</em>{\theta} (\mathbf{x}<em>{0:T}) }{q(\mathbf{x}</em>{1:T}|\mathbf{x}<em>0) }d\mathbf{x}</em>{1:T}] <br> &amp;= -\mathbb{E}<em>{q(\mathbf{x}_0)}[\log (E</em>{ q (\mathbf{x}<em>{1:T}|\mathbf{x}_0)} \frac{ p</em>{\theta} (\mathbf{x}<em>{0:T}) }{q(\mathbf{x}</em>{1:T}|\mathbf{x}<em>0) })] <br> &amp;\leq -\mathbb{E}</em>{q(\mathbf{x}<em>{0:T})}[\log \frac{ p</em>{\theta} (\mathbf{x}<em>{0:T}) }{q(\mathbf{x}</em>{1:T}|\mathbf{x}<em>0) })] = L</em>{VLB} \end{align}$ $\begin{align} L_{VLB} &amp;= \mathbb{E_q}[-\log \frac{p_{\theta}(\mathbf{x}<em>{0:T})}{q(\mathbf{x}</em>{1:T}|\mathbf{x}<em>0)})] \ &amp;= \mathbb{E_q}[-\log p(\mathbf{x}_T)- \sum</em>{t \geq 1}\log \frac{p_{\theta}(\mathbf{x}<em>{t-1}|\mathbf{x}_t)}{q(\mathbf{x}</em>{t}|\mathbf{x}<em>{t-1})})] \ &amp;= \mathbb{E_q}[-\log p(\mathbf{x}_T)- \sum</em>{t &gt;1}\log \frac{p_{\theta}(\mathbf{x}<em>{t-1}|\mathbf{x}_t)}{q(\mathbf{x}</em>{t}|\mathbf{x}<em>{t-1})}) - \log \frac{p</em>{\theta}(\mathbf{x}<em>{0}|\mathbf{x}_1)}{q(\mathbf{x}</em>{1}|\mathbf{x}<em>{0})}] \ &amp;= \mathbb{E_q}[-\log p(\mathbf{x}_T)- \sum</em>{t &gt;1}\log \frac{p_{\theta}(\mathbf{x}<em>{t-1}|\mathbf{x}_t)}{q(\mathbf{x}</em>{t-1}|\mathbf{x}<em>{t}, \mathbf{x}_0)}\frac{q(\mathbf{x}</em>{t-1}|\mathbf{x}<em>0)}{q(\mathbf{x}_t|\mathbf{x}_0)}) - \log \frac{p</em>{\theta}(\mathbf{x}<em>{0}|\mathbf{x}_1)}{q(\mathbf{x}</em>{1}|\mathbf{x}<em>{0})}] \ &amp;= \mathbb{E_q}[-\log \frac{p(\mathbf{x}_T)}{q(\mathbf{x}_T|\mathbf{x}_0)}- \sum</em>{t &gt;1}\log \frac{p_{\theta}(\mathbf{x}<em>{t-1}|\mathbf{x}_t)}{q(\mathbf{x}</em>{t-1}|\mathbf{x}<em>{t}, \mathbf{x}_0)} - \log p</em>{\theta}(\mathbf{x}<em>{0}|\mathbf{x}_1)] \ &amp;= \mathbb{E_q}[ D</em>{\text{KL}}(q(\mathbf{x}<em>T|\mathbf{x}_0)||p</em>(\mathbf{x}<em>T)) + \sum</em>{t&gt;1} D_{\text{KL}}(q(\mathbf{x}<em>{t-1}|\mathbf{x}_t, \mathbf{x}_0)||p</em>{\theta}(\mathbf{x}<em>{t-1}|\mathbf{x}_t))-\log p</em>{\theta}(\mathbf{x}_{0}|\mathbf{x}_1)] \end{align}$</p> <h3 id="some-distributions">Some Distributions</h3> <ul> <li> <table> <tbody> <tr> <td>$q(x_t</td> <td>x_{t-1}):= \mathcal{N}(x_t; \sqrt{1-\beta_t}x_{t-1}, \sqrt{\beta_t}\mathbf{I})$</td> </tr> </tbody> </table> </li> <li> <table> <tbody> <tr> <td>$q(x_t</td> <td>x_0) \sim \mathcal{N} (x_t; \sqrt{\bar{\alpha}_t}x_0, (1 - \bar{\alpha}_t) \mathbf{I})$</td> </tr> </tbody> </table> <ul> <li>Let $\alpha_t = 1 - \beta_t$, $\bar{\alpha}_t = \alpha_1 \alpha_2 \cdots \alpha_t$</li> <li>$\begin{align} x_t &amp;= \sqrt{\alpha_t} x_{t-1} + \sqrt{1-\alpha_t} \epsilon_1 <br> &amp;= \sqrt{\alpha_t \alpha_{t-1}} x_{t-2} + \sqrt{1-\alpha_t} \epsilon_t + \sqrt{\alpha_t - \alpha_t \alpha_{t-1}} \epsilon_{2} <br> &amp;=\sqrt{\alpha_t \alpha_{t-1}}x_{t-2} + \sqrt{1-\alpha_t \alpha_{t-1}} \bar{\epsilon}<em>{2} <br> &amp;= \sqrt{\alpha_t \alpha</em>{t-1} \cdots \alpha_1}x_{0} + \sqrt{1-\alpha_t \alpha_{t-1}\cdots \alpha_0} \bar{\epsilon}_{t} <br> &amp;:= \sqrt{\bar{\alpha_t}} x_0 + \sqrt{1-\bar{\alpha_t}} \bar{\epsilon}_t \end{align}$</li> </ul> </li> <li> <table> <tbody> <tr> <td>$q(x_{t-1}</td> <td>x_t, x_0) \sim \mathcal{N} (x_{t-1}; \tilde{\mu}_t (x_t, x_0), \tilde{\beta}_t \mathbf{I})$</td> </tr> </tbody> </table> <ul> <li><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697757475267-c1edbc41-caec-4570-8222-e847dd71ba0e.png#averageHue=%23f3f3f3&amp;clientId=u961053e4-f864-4&amp;from=paste&amp;height=76&amp;id=ud33762e7&amp;originHeight=151&amp;originWidth=1186&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=37498&amp;status=done&amp;style=none&amp;taskId=u289fa311-77ef-4b37-b8a5-13700311a7d&amp;title=&amp;width=593" alt="image.png"></li> </ul> </li> <li><img src="https://cdn.nlark.com/yuque/0/2023/png/27584564/1697761841777-375e6f5a-04a6-4647-bf0e-780553b06691.png#averageHue=%23f4f4f4&amp;clientId=u2c57025a-ea68-4&amp;from=paste&amp;height=482&amp;id=ua2c47993&amp;originHeight=963&amp;originWidth=1087&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=201395&amp;status=done&amp;style=none&amp;taskId=ufa5fa872-e83b-49ef-8aa1-1a830216d41&amp;title=&amp;width=543.5" alt="image.png"></li> <li>KL divergence of two Gaussian: $D_{KL}(P | Q) = \log\left(\frac{\sigma_Q}{\sigma_P}\right) + \frac{\sigma_P^2 + (\mu_P - \mu_Q)^2}{2\sigma_Q^2} - \frac{1}{2}$ <h1 id="reverse-process">Reverse process</h1> </li> <li> <table> <tbody> <tr> <td>$p_{\theta}(\mathbf{x}_{t-1}</td> <td>\mathbf{x}<em>t) = \mathcal{N}(\mathbf{x}</em>{t-1}; \boldsymbol{\mu}<em>{\theta}(\mathbf{x}_t, t), \boldsymbol{\Sigma}</em>{\theta}(\mathbf{x}_t, t))$for $1 \leq t \leq T$</td> </tr> </tbody> </table> </li> <li>We set$\boldsymbol{\Sigma}<em>{\theta}(x_t, t) = \sigma_t^2 \mathbf{I}$. Experimentally, both $\sigma_t^2 = \beta_t$and $\sigma_t^2 = \tilde{\beta}_t = \frac{1 - \bar{\alpha}</em>{t-1}}{1 - \bar{\alpha}_t} \beta_t$ had similar results <ul> <li>Q: In the reverse, why we set$\boldsymbol{\Sigma}_{\theta}(x_t, t)$to be independent of $x_t$</li> </ul> </li> </ul> </body></html>