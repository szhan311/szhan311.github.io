# Prelimineries
$\mathbf{x}_0 \sim p_0(\mathbf{x}):=q_{\text {data }}(\mathbf{x})$ and $\mathbf{x}_T \sim p_T(\mathbf{x}):=p_{\text {prior }}(\mathbf{x})$
Forward SDE: $d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right) d t+g(t) d \mathbf{w}_t$
Reverse SDE: $\left.d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right)-g(t)^2 \nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t\right)\right) d t+g(t) d \mathbf{w}_t$
Reverse ODE: $d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-\frac{1}{g} g(t)^2 \nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t\right)\right] d t$
The denoising score matching:
$\mathcal{L}(\theta)=\mathbb{E}_{\mathbf{x}_t \sim p\left(\mathbf{x}_t \mid \mathbf{x}_0\right), \mathbf{x}_0 \sim q_{\text {data }}(\mathbf{x}), t \sim \mathcal{U}(0, T)}\left[\left\|\mathbf{s}_\theta\left(\mathbf{x}_t, t\right)-\nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t \mid \mathbf{x}_0\right)\right\|^2\right]$

# Diffusion Process with Fixed Endpoints
![image.png](https://cdn.nlark.com/yuque/0/2023/png/27584564/1699414745464-756ca5dd-db55-42e6-b77a-99ac99ead44b.png#averageHue=%23e7e3de&clientId=u22a16a20-57e3-4&from=paste&height=291&id=uad45a1bb&originHeight=460&originWidth=1152&originalType=binary&ratio=2&rotation=0&showTitle=false&size=456796&status=done&style=none&taskId=u766a4e25-9162-4aae-8ed2-ab3c4a610c9&title=&width=729)

- a diffusion process $d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right) d t+g(t) d \mathbf{w}_t$ can be driven to arrive at a particular point of intetest $y \in \mathbb{R}^d$ almost surely via Doob's $h$-transform: $d \mathbf{x}_t= [\mathbf{f}\left(\mathbf{x}_t, t\right) +g(t)^2 \mathbf{h}\left(\mathbf{x}_t, t, y, T\right)]dt+g(t) d \mathbf{w}_t, \quad \mathbf{x}_0 \sim q_{\text {data }}(\mathbf{x}), \quad \mathbf{x}_T=y$
- where $\mathbf{h}(x, t, y, T)=\left.\nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_T \mid \mathbf{x}_t\right)\right|_{\mathbf{x}_t=x, \mathbf{x}_T=y}$ is the gradient if the log transition kernel of from $t$ to $T$ generated by the original SDE, evaluated at points $\mathbf{x}_t = \mathbf{x}$ and $\mathbf{x}_T = y$, and each $\mathbf{x}_t$ now explicitly depends on $y$ at time $T$.
- **Theorem 1. **The evolution of conditional probability $q(\mathbf{x}_t | \mathbf{x}_T)$ has a time-reversed SDE of the form$d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-g^2(t)\left(\mathbf{s}\left(\mathbf{x}_t, t, y, T\right)-\mathbf{h}\left(\mathbf{x}_t, t, y, T\right)\right)\right] d t+g(t) d \hat{\mathbf{w}}_t, \quad \mathbf{x}_T=y$
- with an associated probability flow ODE $d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-g^2(t)\left(\frac{1}{2} \mathbf{s}\left(\mathbf{x}_t, t, y, T\right)-\mathbf{h}\left(\mathbf{x}_t, t, y, T\right)\right)\right] d t, \quad \mathbf{x}_T=y$
- ![image.png](https://cdn.nlark.com/yuque/0/2023/png/27584564/1699414789423-80fe4fb2-d4b2-4480-b81c-89dd37d211db.png#averageHue=%23e9e9e9&clientId=u22a16a20-57e3-4&from=paste&height=145&id=u06bdc0aa&originHeight=248&originWidth=1243&originalType=binary&ratio=2&rotation=0&showTitle=false&size=65385&status=done&style=none&taskId=u9ceb338f-e97b-4912-b911-e93f3f129e3&title=&width=728.5)


