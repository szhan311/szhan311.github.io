---
layout: post
title:  Denoising Diffusion Bridge Models
date: 2023-12-12 19:51:00
description: 
tags: Literature-review
categories: Diffusion-models
tikzjax: true
---
# Prelimineries
$$\mathbf{x}_0 \sim p_0(\mathbf{x}):=q_{\text {data }}(\mathbf{x})$$ and $$\mathbf{x}_T \sim p_T(\mathbf{x}):=p_{\text {prior }}(\mathbf{x})$$

Forward SDE: $$d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right) d t+g(t) d \mathbf{w}_t$$

Reverse SDE: $$\left.d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right)-g(t)^2 \nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t\right)\right) d t+g(t) d \mathbf{w}_t$$

Reverse ODE: $$d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-\frac{1}{g} g(t)^2 \nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t\right)\right] d t$$

The denoising score matching:

$$\mathcal{L}(\theta)=\mathbb{E}_{\mathbf{x}_t \sim p\left(\mathbf{x}_t \mid \mathbf{x}_0\right), \mathbf{x}_0 \sim q_{\text {data }}(\mathbf{x}), t \sim \mathcal{U}(0, T)}\left[\left\|\mathbf{s}_\theta\left(\mathbf{x}_t, t\right)-\nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_t \mid \mathbf{x}_0\right)\right\|^2\right]$$

# Diffusion Process with Fixed Endpoints
{% include figure.html path="assets/img/diffusion models/bridge01.png" class="img-fluid rounded z-depth-1" %}

- a diffusion process $$d \mathbf{x}_t=\mathbf{f}\left(\mathbf{x}_t, t\right) d t+g(t) d \mathbf{w}_t$$ can be driven to arrive at a particular point of intetest $$y \in \mathbb{R}^d$$ almost surely via Doob's $$h$$-transform: $$d \mathbf{x}_t= [\mathbf{f}\left(\mathbf{x}_t, t\right) +g(t)^2 \mathbf{h}\left(\mathbf{x}_t, t, y, T\right)]dt+g(t) d \mathbf{w}_t, \quad \mathbf{x}_0 \sim q_{\text {data }}(\mathbf{x}), \quad \mathbf{x}_T=y$$

- where $$\mathbf{h}(x, t, y, T)=\nabla_{\mathbf{x}_t} \log p\left(\mathbf{x}_T \mid \mathbf{x}_t\right) \vert_{\mathbf{x}_t=x, \mathbf{x}_T=y}$$ is the gradient if the log transition kernel of from $$t$$ to $$T$$ generated by the original SDE, evaluated at points $$\mathbf{x}_t = \mathbf{x}$$ and $$\mathbf{x}_T = y$$, and each $$\mathbf{x}_t$$ now explicitly depends on $$y$$ at time $$T$$.

- **Theorem 1. **The evolution of conditional probability $$q(\mathbf{x}_t \vert \mathbf{x}_T)$$ has a time-reversed SDE of the form$$d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-g^2(t)\left(\mathbf{s}\left(\mathbf{x}_t, t, y, T\right)-\mathbf{h}\left(\mathbf{x}_t, t, y, T\right)\right)\right] d t+g(t) d \hat{\mathbf{w}}_t, \quad \mathbf{x}_T=y$$
- with an associated probability flow ODE $$d \mathbf{x}_t=\left[\mathbf{f}\left(\mathbf{x}_t, t\right)-g^2(t)\left(\frac{1}{2} \mathbf{s}\left(\mathbf{x}_t, t, y, T\right)-\mathbf{h}\left(\mathbf{x}_t, t, y, T\right)\right)\right] d t, \quad \mathbf{x}_T=y$$

{% include figure.html path="assets/img/diffusion models/bridge02.png" class="img-fluid rounded z-depth-1" %}

